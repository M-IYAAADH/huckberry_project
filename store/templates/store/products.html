{% extends "base.html" %}
{% load static %}

{% block title %}Products{% endblock %}

{% block content %}
<h2 class="page-title" style="text-align: center; margin-bottom: 30px;">Explore Sunglasses</h2>

<!-- Main Layout -->
<div style="display: flex; gap: 20px; align-items: flex-start;">

  <!-- Sidebar Filters -->
  <aside style="width: 250px; padding: 20px; border: 1px solid #ccc; border-radius: 10px;">
    <form method="get">
      <div class="filter-group">
        <h3>Filter by Brand</h3>
        {% for code,label in Product.BRAND_CHOICES %}
          <label style="display: block;">
            <input type="checkbox" name="brand" value="{{ code }}"
                   {% if code in selected_brands %}checked{% endif %}>
            {{ label }}
          </label>
        {% endfor %}
      </div>

      <div class="filter-group" style="margin-top: 20px;">
        <h3>Filter by Gender</h3>
        {% for code,label in Product.GENDER_CHOICES %}
          <label style="display: block;">
            <input type="checkbox" name="gender" value="{{ code }}"
                   {% if code in selected_genders %}checked{% endif %}>
            {{ label }}
          </label>
        {% endfor %}
      </div>

      <div class="filter-group" style="margin-top: 20px;">
        <h3>Filter by Material</h3>
        {% for code,label in Product.MATERIAL_CHOICES %}
          <label style="display: block;">
            <input type="checkbox" name="material" value="{{ code }}"
                   {% if code in selected_materials %}checked{% endif %}>
            {{ label }}
          </label>
        {% endfor %}
      </div>

      <button type="submit" style="margin-top: 20px;" class="button">Apply Filters</button>
    </form>
  </aside>

  <!-- Product Grid -->
  <section style="flex: 1; display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px;">
    {% for product in products %}
      <div class="product-card" style="border: 1px solid #ddd; border-radius: 10px; padding: 15px; text-align: center;">
        {% if product.image %}
          <a href="{% url 'product_detail' product.id %}">
            <img src="{{ product.image.url }}" alt="{{ product.name }}" style="max-width: 100%; height: 150px; object-fit: contain;">
          </a>
        {% endif %}
        <h3 style="margin: 10px 0;">{{ product.name }}</h3>
        <p class="price">MVR {{ product.price|floatformat:2 }}</p>
        <div class="card-actions" style="display: flex; flex-direction: column; gap: 10px; margin-top: 10px;">
          <a href="{% url 'product_detail' product.id %}"
            style="background-color: #2563eb; color: white; padding: 8px; text-align: center; border-radius: 5px; text-decoration: none;">
            View Details
          </a>
          <a href="{% url 'add_to_cart' product.id %}"
            style="background-color: #2563eb; color: white; padding: 8px; text-align: center; border-radius: 5px; text-decoration: none;">
            Add to Cart
          </a>
        </div>

      </div>
    {% endfor %}
  </section>
</div>
{% endblock %}
