{% extends "base.html" %}
{% load static %}

{% block title %}Sunglasses Collection - Huckberry{% endblock %}

{% block content %}
<h2 class="page-title">Explore Sunglasses</h2>

<!-- Filters & Product Layout -->
<div class="container" style="display: flex; gap: 2rem; align-items: flex-start; padding: 0 2rem;">

  <!-- Sidebar Filters -->
  <aside class="filters-container" style="width: 280px; flex-shrink: 0; margin: 0;">
    <div class="filters-header">
      <h3>Filters</h3>
      <a href="{% url 'product_list' %}" class="clear-filters">Clear All</a>
    </div>

    <form method="get">
      <!-- Brand Filter -->
      <div class="filter-group">
        <label>Brand</label>
        <div class="filter-pills" style="flex-direction: column; align-items: flex-start;">
          {% for code,label in Product.BRAND_CHOICES %}
          <label class="filter-checkbox">
            <input type="checkbox" name="brand" value="{{ code }}" {% if code in selected_brands %}checked{% endif %}>
            {{ label }}
          </label>
          {% endfor %}
        </div>
      </div>

      <!-- Gender Filter -->
      <div class="filter-group">
        <label>Gender</label>
        <div class="filter-pills" style="flex-direction: column; align-items: flex-start;">
          {% for code,label in Product.GENDER_CHOICES %}
          <label class="filter-checkbox">
            <input type="checkbox" name="gender" value="{{ code }}" {% if code in selected_genders %}checked{% endif %}>
            {{ label }}
          </label>
          {% endfor %}
        </div>
      </div>

      <!-- Material Filter -->
      <div class="filter-group">
        <label>Material</label>
        <div class="filter-pills" style="flex-direction: column; align-items: flex-start;">
          {% for code,label in Product.MATERIAL_CHOICES %}
          <label class="filter-checkbox">
            <input type="checkbox" name="material" value="{{ code }}" {% if code in selected_materials %}checked{% endif %}>
            {{ label }}
          </label>
          {% endfor %}
        </div>
      </div>

      <button type="submit" class="button" style="width: 100%; margin-top: 1.5rem;">Apply Filters</button>
    </form>
  </aside>

  <!-- Product Grid -->
  <section class="product-grid" style="flex: 1; padding: 0; max-width: none;">
    {% for product in products %}
    <article class="product-card">
      <!-- Product Image -->
      {% if product.image %}
      <div class="product-image-wrapper">
        <a href="{% url 'product_detail' product.id %}">
          <img src="{{ product.image.url }}" alt="{{ product.name }}">
        </a>
      </div>
      {% endif %}

      <!-- Product Info -->
      <p class="product-category">{{ product.get_brand_display }} - {{ product.get_gender_display }}</p>
      <h3 class="product-name">
        <a href="{% url 'product_detail' product.id %}">{{ product.name }}</a>
      </h3>
      <p class="price">MVR {{ product.price|floatformat:2 }}</p>

      <!-- Actions -->
      <div class="product-actions" style="margin-top: 1rem;">
        <a href="{% url 'product_detail' product.id %}" class="button-small button-secondary" style="flex: 1;">View</a>
        <a href="{% url 'add_to_cart' product.id %}" class="button-small" style="flex: 1;">Add to Cart</a>
      </div>
    </article>
    {% empty %}
    <div class="empty-cart" style="grid-column: 1 / -1;">
      <h2>No products found</h2>
      <p>Try adjusting your filters or check back later.</p>
      <a href="{% url 'product_list' %}" class="button">Clear Filters</a>
    </div>
    {% endfor %}
  </section>
</div>
{% endblock %}
